#!/usr/bin/env ruby

#typed: true

$LOAD_PATH << File.dirname(__FILE__) + "/../config/"
require 'init'

require 'logger'
require 'googleauth'
require 'google/apis/sheets_v4'
require 'google/apis/drive_v3'
require 'date'
require 'time'
require 'tzinfo'
require "reverse_markdown"

class BatchSheet < T::Struct
  const :id, String
  const :name, String
  prop :rows, Integer
end



LOGGER = Logger.new($stdout)
$stdout.sync = true
sheet = GoogleSheet.new(folder_id: '1mZO5hWUZFNTgnkb7tvDrvG3x2mVOxCeU',
                        logger: LOGGER)

store = CivilServiceJobsScraper::DynamoDbResultStore.new

store.each.with_index do |job, i|
  sheet.add_job(job, i)
end
sheet.flush!
